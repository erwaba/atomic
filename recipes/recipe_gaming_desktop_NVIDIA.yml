---
# yaml-language-server: $schema=https://schema.blue-build.org/recipe-v1.json
# image will be published to ghcr.io/<user>/<name>
name: gaming_desktop_nvidia
# description will be included in the image's metadata
description: Bazzite image for gaming desktop with modern NVIDIA GPU.

# the base image to build on top of (FROM) and the version tag to use
base-image: ghcr.io/ublue-os/bazzite-nvidia-open
image-version: stable # latest is also supported if you want new updates ASAP

# module configuration, executed in order
# you can include multiple instances of the same module
modules:
# run modules common to all recipes
  - from-file: common_modules.yml
# reverse Bazzite's promotion of gaming apps for laptops not orientated towards gaming
  - type: containerfile
    snippets:
# reverse Bazzite's decision to autostart Steam by placing it in /etc/skel
    - RUN rm /etc/skel/.config/autostart/steam.desktop
# include containerfile that installs resticprofile
  - type: containerfile
    containerfiles:
      - resticprofile
# copy gaming monitor EDID and dracut conf to include in initramfs
#  - type: files
#    files:
  #    - source: edid/monitor.edid
  #      destination: /usr/lib/firmware/edid/monitor.edid
  #    - source: dracut/edid.conf
  #      destination: /etc/dracut.conf.d/edid.conf
# inject kernel argument into image build
  #- type: kargs
  #  kargs:
  #    - nvidia-drm.modeset=1
  #    - video=DP-1:e  # forces port to be active
  #    - rd.driver.pre=nvidia  # forces driver to wait for initramfs to be ready before handshake
  #    - drm.edid_firmware=DP-1:edid/monitor.edid
# trigger regeneration of initramfs to include new files (requires Fedora 41+)
  #- type: initramfs
